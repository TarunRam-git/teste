{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ashke\\\\OneDrive\\\\Desktop\\\\test\\\\teste\\\\client\\\\src\\\\WatchParty.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport './WatchParty.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:3001'); // Adjust if your server URL is different\n\nconst WatchParty = ({\n  partyVideoId,\n  setVideoId\n}) => {\n  _s();\n  const [partyCode, setPartyCode] = useState('');\n  const [isHost, setIsHost] = useState(false);\n  const [videoId, setLocalVideoId] = useState(partyVideoId || null);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  const playerRef = useRef(null);\n\n  // Sync video state with the socket server\n  const syncVideoState = useCallback(() => {\n    if (playerRef.current) {\n      const time = playerRef.current.getCurrentTime();\n      const isPlaying = playerRef.current.getPlayerState() === 1; // 1 is playing state\n      socket.emit('sync-video', {\n        code: partyCode,\n        videoId,\n        currentTime: time,\n        playing: isPlaying\n      });\n    }\n  }, [partyCode, videoId]);\n\n  // Create a watch party\n  const createParty = () => {\n    const code = Math.random().toString(36).substring(2, 8); // Generate a party code\n    socket.emit('create-party', {\n      code,\n      videoId\n    });\n    setPartyCode(code);\n    setIsHost(true);\n    alert(`Party created! Your party code is: ${code}`);\n  };\n\n  // Join a watch party\n  const joinParty = () => {\n    socket.emit('join-party', {\n      code: partyCode\n    });\n  };\n\n  // Handle incoming sync-video messages\n  useEffect(() => {\n    socket.on('sync-video', data => {\n      setLocalVideoId(data.videoId);\n      setCurrentTime(data.currentTime);\n      setPlaying(data.playing);\n    });\n    return () => {\n      socket.off('sync-video'); // Clean up the event listener\n    };\n  }, []);\n\n  // Initialize YouTube Player with sync logic\n  useEffect(() => {\n    if (videoId) {\n      playerRef.current = new window.YT.Player('videoPlayer', {\n        videoId,\n        events: {\n          onReady: event => {\n            event.target.seekTo(currentTime);\n            if (playing) {\n              event.target.playVideo();\n            }\n\n            // Listen for player state changes\n            event.target.addEventListener('onStateChange', event => {\n              if (event.data === 1 || event.data === 2 || event.data === 3) {\n                // Play, Pause, Seek\n                syncVideoState(); // Sync state when playing, paused, or seeking\n              }\n            });\n          }\n        }\n      });\n    }\n    return () => {\n      if (playerRef.current) {\n        playerRef.current.destroy(); // Cleanup player instance\n      }\n    };\n  }, [videoId, currentTime, playing, syncVideoState]); // Add syncVideoState here\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"watch-party\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Watch Party\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), isHost ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Your Party Code: \", partyCode]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Share this code with friends!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter party code\",\n        value: partyCode,\n        onChange: e => setPartyCode(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: joinParty,\n        children: \"Join Party\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: createParty,\n      children: \"Create Party\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), videoId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-player\",\n      children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n        id: \"videoPlayer\",\n        width: \"560\",\n        height: \"315\",\n        src: `https://www.youtube.com/embed/${videoId}?enablejsapi=1`,\n        title: \"YouTube video player\",\n        frameBorder: \"0\",\n        allow: \"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\",\n        allowFullScreen: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(WatchParty, \"aWBqA4mQVDr9bzEQ9F67XpktB8k=\");\n_c = WatchParty;\nexport default WatchParty;\nvar _c;\n$RefreshReg$(_c, \"WatchParty\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useCallback","io","jsxDEV","_jsxDEV","socket","WatchParty","partyVideoId","setVideoId","_s","partyCode","setPartyCode","isHost","setIsHost","videoId","setLocalVideoId","currentTime","setCurrentTime","playing","setPlaying","playerRef","syncVideoState","current","time","getCurrentTime","isPlaying","getPlayerState","emit","code","createParty","Math","random","toString","substring","alert","joinParty","on","data","off","window","YT","Player","events","onReady","event","target","seekTo","playVideo","addEventListener","destroy","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","value","onChange","e","onClick","id","width","height","src","title","frameBorder","allow","allowFullScreen","_c","$RefreshReg$"],"sources":["C:/Users/ashke/OneDrive/Desktop/test/teste/client/src/WatchParty.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport './WatchParty.css';\r\n\r\nconst socket = io('http://localhost:3001'); // Adjust if your server URL is different\r\n\r\nconst WatchParty = ({ partyVideoId, setVideoId }) => {\r\n  const [partyCode, setPartyCode] = useState('');\r\n  const [isHost, setIsHost] = useState(false);\r\n  const [videoId, setLocalVideoId] = useState(partyVideoId || null);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [playing, setPlaying] = useState(false);\r\n  const playerRef = useRef(null);\r\n\r\n  // Sync video state with the socket server\r\n  const syncVideoState = useCallback(() => {\r\n    if (playerRef.current) {\r\n      const time = playerRef.current.getCurrentTime();\r\n      const isPlaying = playerRef.current.getPlayerState() === 1; // 1 is playing state\r\n      socket.emit('sync-video', { code: partyCode, videoId, currentTime: time, playing: isPlaying });\r\n    }\r\n  }, [partyCode, videoId]);\r\n\r\n  // Create a watch party\r\n  const createParty = () => {\r\n    const code = Math.random().toString(36).substring(2, 8); // Generate a party code\r\n    socket.emit('create-party', { code, videoId });\r\n    setPartyCode(code);\r\n    setIsHost(true);\r\n    alert(`Party created! Your party code is: ${code}`);\r\n  };\r\n\r\n  // Join a watch party\r\n  const joinParty = () => {\r\n    socket.emit('join-party', { code: partyCode });\r\n  };\r\n\r\n  // Handle incoming sync-video messages\r\n  useEffect(() => {\r\n    socket.on('sync-video', (data) => {\r\n      setLocalVideoId(data.videoId);\r\n      setCurrentTime(data.currentTime);\r\n      setPlaying(data.playing);\r\n    });\r\n\r\n    return () => {\r\n      socket.off('sync-video'); // Clean up the event listener\r\n    };\r\n  }, []);\r\n\r\n  // Initialize YouTube Player with sync logic\r\n  useEffect(() => {\r\n    if (videoId) {\r\n      playerRef.current = new window.YT.Player('videoPlayer', {\r\n        videoId,\r\n        events: {\r\n          onReady: (event) => {\r\n            event.target.seekTo(currentTime);\r\n            if (playing) {\r\n              event.target.playVideo();\r\n            }\r\n\r\n            // Listen for player state changes\r\n            event.target.addEventListener('onStateChange', (event) => {\r\n              if (event.data === 1 || event.data === 2 || event.data === 3) { // Play, Pause, Seek\r\n                syncVideoState(); // Sync state when playing, paused, or seeking\r\n              }\r\n            });\r\n          },\r\n        },\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      if (playerRef.current) {\r\n        playerRef.current.destroy(); // Cleanup player instance\r\n      }\r\n    };\r\n  }, [videoId, currentTime, playing, syncVideoState]); // Add syncVideoState here\r\n\r\n  return (\r\n    <div className=\"watch-party\">\r\n      <h2>Watch Party</h2>\r\n      {isHost ? (\r\n        <div>\r\n          <h3>Your Party Code: {partyCode}</h3>\r\n          <p>Share this code with friends!</p>\r\n        </div>\r\n      ) : (\r\n        <div>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter party code\"\r\n            value={partyCode}\r\n            onChange={(e) => setPartyCode(e.target.value)}\r\n          />\r\n          <button onClick={joinParty}>Join Party</button>\r\n        </div>\r\n      )}\r\n      <button onClick={createParty}>Create Party</button>\r\n\r\n      {/* Video Player */}\r\n      {videoId && (\r\n        <div className=\"video-player\">\r\n          <iframe\r\n            id=\"videoPlayer\"\r\n            width=\"560\"\r\n            height=\"315\"\r\n            src={`https://www.youtube.com/embed/${videoId}?enablejsapi=1`}\r\n            title=\"YouTube video player\"\r\n            frameBorder=\"0\"\r\n            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n            allowFullScreen\r\n          ></iframe>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WatchParty;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}